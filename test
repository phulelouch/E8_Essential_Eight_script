# Create a valid minimal executable for testing
$exeTestFile = "TestExecutable.exe"

# This is a simple Windows executable that displays a message box and exits
# It's encoded as base64 to ensure proper binary creation
$validExeContent = @'
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
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
'@

try {
    # Convert base64 to bytes and write to file
    $bytes = [Convert]::FromBase64String($validExeContent)
    [System.IO.File]::WriteAllBytes($exeTestFile, $bytes)
    Write-Host "Created valid test executable at $exeTestFile" -ForegroundColor Green
    Write-Host "This is a benign executable that displays a message box and exits" -ForegroundColor Cyan
} catch {
    Write-Host "Error creating test executable $exeTestFile $_" -ForegroundColor Red
}
