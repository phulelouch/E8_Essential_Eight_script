# Define the test executable filename
$exeTestFile = "TestExecutable.exe"

# Base64 encoded minimal x64 Windows executable
# This executable displays a message box with "Hello from Test Executable!" and exits
$base64Exe = @"
TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAAZIYCALp1K2cAAAAAAAAAAPA AKwILAgMAACAAAAACAAAAAAAAAAAAACAAAAAAAAAAgAAAAEAAAAAAAAACAAAGAAEAAAAAAAAGAAAAAAAAAGAAAAACAAAAAAAAAwBAhQAAEAAAAAAQAAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAAAAAQAAAOAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC50ZXh0AAAAPgAAAAAgAAAAAgAAAAIAAAAAAAAAAAAAAAAAACAAAGAuaWRhdGEAADgCAAAAQAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAgAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASIPsKEiNDQsBAABIjRUaAQAARTPA6AYAAABIg8Qow0iD7ChIM8lFM8lFM8DoLgAAAEiDxCjDzMzMzMzMzMxIiVwkCFdIg+wgSI0F6AEAAEiL+EiJBdH+//9IjQXC/v//SIkF2/7//0iNBaT+//9IiQUF////SI0FNgEAAEiJBRf///9IjR0I////SIsDSIXAdBH/0EiDwwhIjQX3/v//SDnDcu9Ii1wkMEiDxCBfw8zMzEiD7ChIjQ2JAAAA6AAAAAAAAAAAAAAAAA8fAEBVSIPsIEiL6kiLAUiLEEiLyf9SSIPEIAXj/////EBIOE0IOQAAAEG6ZXNzYWdlQm94QQBIiwXh/v//AEhlbGxvIGZyb20gVGVzdCBFeGVjdXRhYmxlIQBUZXN0IEV4ZWN1dGFibGUAAAAAAAAAALgBAAAAAAAAuAEAAAAAAAAAAAAAAAAAAEABAAAAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIAQAAAAAAAAAAAAAAAAAAAAAAAFVTRVIzMi5kbGwAAAAAAE1lc3NhZ2VCb3hBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
"@

# Convert base64 to bytes and write to file
$exeBytes = [Convert]::FromBase64String($base64Exe)
[System.IO.File]::WriteAllBytes($exeTestFile, $exeBytes)

Write-Host "Test executable created: $exeTestFile" -ForegroundColor Green
Write-Host "This is a minimal x64 Windows executable that displays a message box." -ForegroundColor Yellow

# Optionally, you can test run it (uncomment the line below)
# Start-Process -FilePath $exeTestFile
